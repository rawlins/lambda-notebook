<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kyle Rawlins">
<meta name="dcterms.date" content="2024-08-26">

<title>Lambda notebook demo – Lambda Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Lambda Notebook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./demo-for-linguists.html" aria-current="page"> 
<span class="menu-text">Demo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./CHANGELOG.html"> 
<span class="menu-text">Changelog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/rawlins/lambda-notebook"> 
<span class="menu-text">Source</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#first-pitch-to-a-theoretical-linguist" id="toc-first-pitch-to-a-theoretical-linguist" class="nav-link active" data-scroll-target="#first-pitch-to-a-theoretical-linguist"><span class="header-section-number">1</span> First pitch to a theoretical linguist</a></li>
  <li><a href="#background-two-problems-in-formal-semantics" id="toc-background-two-problems-in-formal-semantics" class="nav-link" data-scroll-target="#background-two-problems-in-formal-semantics"><span class="header-section-number">2</span> Background: Two problems in formal semantics</a>
  <ul class="collapse">
  <li><a href="#the-role-of-formalism-fragments-in-semantics" id="toc-the-role-of-formalism-fragments-in-semantics" class="nav-link" data-scroll-target="#the-role-of-formalism-fragments-in-semantics"><span class="header-section-number">2.1</span> The role of formalism &amp; fragments in semantics</a></li>
  <li><a href="#the-challenges-of-fragments" id="toc-the-challenges-of-fragments" class="nav-link" data-scroll-target="#the-challenges-of-fragments"><span class="header-section-number">2.2</span> The challenges of fragments</a></li>
  </ul></li>
  <li><a href="#a-solution-digital-fragments" id="toc-a-solution-digital-fragments" class="nav-link" data-scroll-target="#a-solution-digital-fragments"><span class="header-section-number">3</span> A solution: digital fragments</a>
  <ul class="collapse">
  <li><a href="#part-1-flexible-typed-metalanguage" id="toc-part-1-flexible-typed-metalanguage" class="nav-link" data-scroll-target="#part-1-flexible-typed-metalanguage"><span class="header-section-number">3.1</span> Part 1: flexible typed metalanguage</a>
  <ul class="collapse">
  <li><a href="#model-theory-and-evaluation" id="toc-model-theory-and-evaluation" class="nav-link" data-scroll-target="#model-theory-and-evaluation"><span class="header-section-number">3.1.1</span> Model theory and evaluation</a></li>
  </ul></li>
  <li><a href="#part-2-composition-systems-for-an-object-language" id="toc-part-2-composition-systems-for-an-object-language" class="nav-link" data-scroll-target="#part-2-composition-systems-for-an-object-language"><span class="header-section-number">3.2</span> Part 2: composition systems for an object language</a>
  <ul class="collapse">
  <li><a href="#composition-in-tree-structures" id="toc-composition-in-tree-structures" class="nav-link" data-scroll-target="#composition-in-tree-structures"><span class="header-section-number">3.2.1</span> Composition in tree structures</a></li>
  </ul></li>
  <li><a href="#part-3-human-readable-rendering-of-structured-python-objects" id="toc-part-3-human-readable-rendering-of-structured-python-objects" class="nav-link" data-scroll-target="#part-3-human-readable-rendering-of-structured-python-objects"><span class="header-section-number">3.3</span> Part 3: human readable rendering of structured python objects</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/rawlins/lambda-notebook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lambda notebook demo</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kyle Rawlins <a href="mailto:kgr@jhu.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://github.com/rawlins/lambda-notebook/blob/master/docs/demo-for-linguists.ipynb">Download this notebook</a> for interactive use.</p>
<section id="first-pitch-to-a-theoretical-linguist" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> First pitch to a theoretical linguist</h1>
<p>Have you ever wanted to type something like this in, and have it actually do something?</p>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>every<span class="op">||</span> <span class="op">=</span> λ f_<span class="op">&lt;</span>e,t<span class="op">&gt;</span> : λ g_<span class="op">&lt;</span>e,t<span class="op">&gt;</span> : Forall x_e : f(x) <span class="op">&gt;&gt;</span> g(x)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>cat<span class="op">||</span> <span class="op">=</span> L x_e : Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>meowed<span class="op">||</span> <span class="op">=</span> L x_e : Meowed_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> ((every <span class="op">*</span> cat) <span class="op">*</span> meowed)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>r.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The lambda notebook project aims to make this happen. It provides:</p>
<ol type="1">
<li>flexible typed metalanguage: a superset of first-order predicate logic, together with a rich type theory.</li>
<li>a framework for doing semantic composition on natural language syntax</li>
<li>an api for rendering the structured python objects in layers 1-2 in easy-to-read MathJax (web-oriented LaTeX code) and HTML.</li>
</ol>
</section>
<section id="background-two-problems-in-formal-semantics" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Background: Two problems in formal semantics</h1>
<ol type="1">
<li><p>Type-driven computation could be a lot easier to visualize and check.</p></li>
<li><p>Grammar fragments as in Montague Grammar: good idea in principle, hard to use in practice.</p></li>
</ol>
<ul>
<li>A <strong>fragment</strong> is a <em>complete</em> formalization of <em>sublanguage</em> consisting of the <em>key relevant phenomena</em> for the problem at hand. (Potential problem-points italicized.)</li>
</ul>
<p>Solution: a system for developing interactive fragments: the “<em>Lambda Notebook</em>” project.</p>
<ul>
<li>Creator can work interactively with analysis – accelerate development, limit time spent on tedious details.</li>
<li>Reader can explore derivations in ways that are not typically possible in typical paper format.</li>
<li>Creator and reader can be certain that derivations work, verified by the system.</li>
<li>Bring closer together formal semantics and computational modeling.</li>
</ul>
<p>Inspirations and related projects:</p>
<ul>
<li><span class="citation" data-cites="vanEijckUnger10">Eijck and Unger (<a href="#ref-vanEijckUnger10" role="doc-biblioref">2010</a>)</span>: implementation of compositional semantics in Haskell. No interface (beyond standard Haskell terminal); great if you like Haskell. There’s a rich tradition of programmer linguists writing fragments in Haskell following this book.</li>
<li>The <a href="http://lambdacalculator.com/">Lambda calculator</a> <span class="citation" data-cites="PennLambda">(originally, the UPenn Lambda Calculator, <a href="#ref-PennLambda" role="doc-biblioref">Champollion, Tauberer, and Romero 2007</a>)</span>: teaching oriented implementation of lambda calculus in Java.</li>
<li><a href="https://www.nltk.org/api/nltk.sem.html"><code>nltk.sem</code></a>: implementation of the lambda calculus with a typed metalanguage, interface with theorem provers. No interactive interface.</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-PennLambda" class="csl-entry" role="listitem">
Champollion, L., J. Tauberer, and M. Romero. 2007. <span>“The <span>Penn Lambda Calculator</span>: Pedagogical Software for Natural Language Semantics.”</span> In <em>Proceedings of the Grammar Engineering Across Frameworks (<span>GEAF</span>) 2007 Workshop</em>, edited by T. Holloway King and E. M. Bender. <a href="https://www.ling.upenn.edu/~champoll/lambda-geaf.pdf">https://www.ling.upenn.edu/~champoll/lambda-geaf.pdf</a>.
</div></div><section id="the-role-of-formalism-fragments-in-semantics" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="the-role-of-formalism-fragments-in-semantics"><span class="header-section-number">2.1</span> The role of formalism &amp; fragments in semantics</h2>
<p>What does <em>formal</em> mean in semantics? What properties should a theory have?</p>
<ol type="1">
<li>Mathematically precise (lambda calculus, type theory, logic, model theory(?), …)</li>
<li>Complete (covers “all” the relevant data).</li>
<li>Predictive (like any scientific theory).</li>
<li>Consistent, or at least compatible (with itself, analyses of other phenomena, some unifying conception of the grammar).</li>
</ol>
<p>The <em>method of fragments</em> <span class="citation" data-cites="Partee79 ParteeHendriks97">(<a href="#ref-Partee79" role="doc-biblioref">Partee 1979</a>; <a href="#ref-ParteeHendriks97" role="doc-biblioref">Partee and Hendriks 1997</a>)</span> provides a structure for meeting these criteria.</p>
<div class="no-row-height column-margin column-container"><div id="ref-ParteeHendriks97" class="csl-entry" role="listitem">
Partee, Barbara H., and Herman L. W. Hendriks. 1997. <span>“Montague Grammar.”</span> In <em>Handbook of Logic and Language</em>, edited by Johan van Benthem and Alice G. B. ter Meulen, 5–91. Elsevier; MIT Press. <a href="https://doi.org/10.1016/B978-044481714-3/50004-7">https://doi.org/10.1016/B978-044481714-3/50004-7</a>.
</div></div><ul>
<li>Paper with a fragment provides a working system. (Probably.)</li>
<li>Explicit outer bound for empirical coverage.</li>
<li>Integration with a particular theory of grammar. (To some extent.)</li>
<li>Explicit answer to many detailed questions not necessarily dealt with in the text.</li>
</ul>
<p><strong>Claim</strong>: fragments are a method of replicability, similar to a computational modeller providing their model.</p>
<ul>
<li>To be clear, a fragment is neither necessary nor sufficient for having a good theory / analysis / paper…</li>
</ul>
<p>Additional benefit: useful internal check for researcher.</p>
<blockquote class="blockquote">
<p>“…But I feel strongly that it is important to try to [work with fully explicit fragments] periodically, because otherwise it is extremely easy to think that you have a solution to a problem when in fact you don’t.” (Partee 1979, p.&nbsp;41)</p>
</blockquote>
</section>
<section id="the-challenges-of-fragments" class="level2 page-columns page-full" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-challenges-of-fragments"><span class="header-section-number">2.2</span> The challenges of fragments</h2>
<p>Part 1 of the above quote:</p>
<blockquote class="blockquote">
<p>“It can be very frustrating to try to specify frameworks and fragments explicitly; this project has not been entirely rewarding. I would not recommend that one always work with the constraint of full explicitness.” (Ibid.)</p>
</blockquote>
<ul>
<li><p>Fragments can be tedious and time-consuming to write (not to mention hard).</p></li>
<li><p>Fragments as traditionally written are in practice not easy for a reader to use.</p>
<ul>
<li>Dense/unapproachable. With exactness can come a huge chunk of hard-to-digest formalism. E.g. <span class="citation" data-cites="Partee79">Partee (<a href="#ref-Partee79" role="doc-biblioref">1979</a>)</span>, the fragment is about 10% of the paper.</li>
<li>Monolithic/non-modular. For the specified sublanguage, everything is specified. Outside the bounds of the sublanguage, nothing is specified. How does the theory fit in with others?</li>
<li>Exact opposite of the modern method – researchers typically hold most aspects of the grammar constant (implicitly) while changing a few key points. <span class="citation" data-cites="PortnerPartee02">(See e.g., the introduction to <a href="#ref-PortnerPartee02" role="doc-biblioref">Portner and Partee 2002</a> for discussion.)</span></li>
</ul></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-Partee79" class="csl-entry" role="listitem">
Partee, Barbara H. 1979. <span>“Constraining Transformational <span>M</span>ontague Grammar: A Framework and a Fragment.”</span> In <em>Linguistics, Philosophy, and <span>M</span>ontague Grammar</em>, edited by S. Davis and M. Mithun, 51–101. University of <span>T</span>exas Press. <a href="https://doi.org/10.7560/746251-004">https://doi.org/10.7560/746251-004</a>.
</div><div id="ref-PortnerPartee02" class="csl-entry" role="listitem">
Portner, Paul, and Barbara Partee, eds. 2002. <em>Formal Semantics: The Essential Readings</em>. Blackwell Publishing.
</div></div><p><strong>Summary:</strong> In practice, the typical payoff for neither the reader nor the writer of a fragment exceeded the effort.</p>
</section>
</section>
<section id="a-solution-digital-fragments" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> A solution: digital fragments</h1>
<p><span class="citation" data-cites="vanEijckUnger10">Eijck and Unger (<a href="#ref-vanEijckUnger10" role="doc-biblioref">2010</a>)</span>’s solution: we can (and perhaps should) specify a fragment in digital form.</p>
<div class="no-row-height column-margin column-container"><div id="ref-vanEijckUnger10" class="csl-entry" role="listitem">
Eijck, Jan van, and Christina Unger. 2010. <em>Computational Semantics with Functional Programming</em>. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511778377">https://doi.org/10.1017/CBO9780511778377</a>.
</div></div><ul>
<li>They use Haskell. Type system of Haskell extremely well-suited to natural language semantics.</li>
<li>(Provocative statement) Interface, learning curve of Haskell not well suited to semanticists (or most people)? At a minimum: reading code is not always easy.</li>
</ul>
<p><strong>Benefits of digital fragments (in principle)</strong></p>
<ul>
<li>Interactive.</li>
<li>Easy to distribute, adapt, modify.</li>
<li>Possibility of modularity. (E.g. abstract a ‘library’ for compositional systems away from the analysis of a particular phenomenon.)</li>
<li>Bring closer together the CogSci idea of a ‘computational model’ to the project of natural language semantics.</li>
</ul>
<p><strong>What sorts of things might we want in a fragment / system for fragments?</strong></p>
<ul>
<li>Typed lambda calculus.</li>
<li>Logic / logical metalanguage.</li>
<li>Model theory.</li>
<li>Framework for semantic composition.</li>
</ul>
<p>The Lambda Notebook project aims to provide these tools in a usable, interactive, format, built on type of Python.</p>
<section id="part-1-flexible-typed-metalanguage" class="level2 page-columns page-full" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="part-1-flexible-typed-metalanguage"><span class="header-section-number">3.1</span> Part 1: flexible typed metalanguage</h2>
<p>The <strong>metalanguage</strong> infrastructure is a set of python classes that implement the building blocks of logical expressions, lambda terms, and various other formal objects, as well as complex formulas built from these pieces. This rests on an implementation of a framework for <strong>type systems</strong> that matches what semanticists tend to assume.</p>
<p>Preface cell with <code>%%lamb</code> to enter metalanguage formulas directly. The following cell defines a variable <code>x</code> that has type e, and exports it to the notebook’s environment.</p>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb reset</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x_e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x.<span class="bu">type</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This next cell defines some variables whose values are more complex object – in fact, functions in the typed lambda calculus.</p>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>test1 <span class="op">=</span> L p_t : L x_e : P_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x) <span class="op">&amp;</span> p <span class="co"># based on a Partee et al example</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>test1b <span class="op">=</span> L x_e : P_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x) <span class="op">&amp;</span> Q_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> Q_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x_e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are now registered as variables in the python namespace and can be manipulated directly. A typed lambda calculus is fully implemented with all that that entails – e.g.&nbsp;the value of <code>test1</code> includes the whole syntactic structure of the formula, its type, etc. and can be used in constructing new formulas. The following cells build a complex function-argument formula, and following that, does the reduction.</p>
<p>Notice that beta reduction works properly, i.e.&nbsp;bound <span class="math inline">\(x\)</span> in the function is renamed in order to avoid collision with the free <code>x</code> in the argument. <span class="citation" data-cites="PMW93">(<code>test1b</code> is based on an example illustrating alpha conversion from <a href="#ref-PMW93" role="doc-biblioref">Partee, Meulen, and Wall 1993</a>.)</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-PMW93" class="csl-entry" role="listitem">
Partee, Barbara H., Alice ter Meulen, and Robert Wall. 1993. <em>Mathematical Methods in Linguistics</em>. Dordrecht: Kluwer. <a href="https://doi.org/10.1007/978-94-009-2213-6">https://doi.org/10.1007/978-94-009-2213-6</a>.
</div></div><div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test1(t2) <span class="co"># construct a complex function-argument expression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>test1(t2).<span class="bu">reduce</span>() <span class="co"># do reduction on that expression</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>catf <span class="op">=</span> L x_e: Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>dogf <span class="op">=</span> λx: Dog_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x_e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>display(catf(x), (catf(x)).<span class="bu">type</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>catf.<span class="bu">type</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Type checking of course is a part of all this. If the types don’t match, the computation will throw a <code>TypeMismatch</code> exception. The following cell uses python syntax to catch and print such errors.</p>
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> lamb.errors():</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    test1(x) <span class="co"># function is type &lt;t,&lt;e,t&gt;&gt; so will trigger a type mismatch.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A more complex expression:</p>
<div id="cell-27" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> (Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x_e) <span class="op">&amp;</span> p_t) <span class="op">&gt;&gt;</span> (Exists y: Dog_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(y_e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is going on behind the scenes? The objects manipulated are recursively structured python objects (of class <code>TypedExpr</code>). Each layer of recursion stores information about the kind of metalanguage expression it is, as well as its parts.</p>
<p>Many straightforward expressions can be parsed. Most expressions are created using a call to TypedExpr.factory, which is abbreviated as “te” in the following examples. The <code>%%lamb</code> magic is calling this behind the scenes.</p>
<div id="cell-29" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="op">%</span>te x_e</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Various convenience python operators are overloaded, including functional calls. Here is an example repeated from earlier in two forms:</p>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> (Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x_e) <span class="op">&amp;</span> p_t) <span class="op">&gt;&gt;</span> (Exists y: Dog_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(y_e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> (te(<span class="st">"Cat_&lt;e,t&gt;(x)"</span>) <span class="op">&amp;</span> te(<span class="st">"p_t"</span>)) <span class="op">&gt;&gt;</span> te(<span class="st">"(Exists y: Dog_&lt;e,t&gt;(y_e))"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s examine in detail what happens when a function and argument combine.</p>
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>catf <span class="op">=</span> meta.LFun(te(<span class="st">"x_e"</span>), te(<span class="st">"Cat(x_e)"</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>catf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>catf(te(<span class="st">"y_e"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Building a function-argument expression builds a complex, unreduced expression. This can be explicitly reduced (note that the <code>reduce_all()</code> function would be used to apply reduction recursively):</p>
<div id="cell-37" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>catf(te(<span class="st">"y_e"</span>)).<span class="bu">reduce</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(catf(te(<span class="st">"y_e"</span>)).<span class="bu">reduce</span>()).derivation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The metalanguage supports type polymorphism. For example, we can define a function whose input type is a type variable (<code>X</code>) and then combine that function with a concrete type, to force type narrowing:</p>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>lamb ttest <span class="op">=</span> L x_X : P_<span class="op">&lt;</span>X,t<span class="op">&gt;</span>(x)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>lamb tvar <span class="op">=</span> y_t</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ttest(tvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Other operators not illustrated here include set theoretic expressions, tools for building partial functions and denotations, a rich approach to “meta-meta-language”, restricted quantifiers, and more.</p>
<section id="model-theory-and-evaluation" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="model-theory-and-evaluation"><span class="header-section-number">3.1.1</span> Model theory and evaluation</h3>
<p>The lambda notebook supports model theory and evaluation of extensional formulas.</p>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> meta.Model({<span class="st">'A'</span>: <span class="st">'_c1'</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">'B'</span>: <span class="st">'_c2'</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">'C'</span>: <span class="st">'_c1'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: {<span class="st">'A'</span>, <span class="st">'B'</span>}},</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>               domain<span class="op">=</span>{<span class="st">'_c1'</span>, <span class="st">'_c2'</span>, <span class="st">'_c3'</span>})</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m.evaluate(te(<span class="st">"Exists x_e : P_&lt;e,t&gt;(x)"</span>)).derivation.trace()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m.evaluate(te(<span class="st">"Forall x_e : P_&lt;e,t&gt;(x)"</span>)).derivation.trace()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="part-2-composition-systems-for-an-object-language" class="level2 page-columns page-full" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="part-2-composition-systems-for-an-object-language"><span class="header-section-number">3.2</span> Part 2: composition systems for an object language</h2>
<p>On top of the metalanguage are ‘<strong>composition systems</strong>’ for modeling (step-by-step) semantic composition in an object language such as English. This is the part of the lambda notebook that tracks and manipulates mappings between object language elements (words, trees, etc) and denotations in the metalanguage.</p>
<p>A composition system at its core consists of a set of composition rules; the following cell defines a simple composition system that will be familiar to anyone who has taken a basic course in compositional semantics. <span class="citation" data-cites="HeimKratzer98 IFS24">(See among others, <a href="#ref-HeimKratzer98" role="doc-biblioref">Heim and Kratzer 1998</a>; <a href="#ref-IFS24" role="doc-biblioref">Coppock and Champollion 2024</a>)</span></p>
<div class="no-row-height column-margin column-container"></div><div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># none of this is strictly necessary, the built-in library already provides effectively this system.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fa <span class="op">=</span> lang.BinaryCompositionOp(<span class="st">"FA"</span>, lang.fa_fun, <span class="bu">reduce</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>pm <span class="op">=</span> lang.BinaryCompositionOp(<span class="st">"PM"</span>, lang.pm_fun, commutative<span class="op">=</span><span class="va">True</span>, <span class="bu">reduce</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>pa <span class="op">=</span> lang.BinaryCompositionOp(<span class="st">"PA"</span>, lang.pa_fun, allow_none<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>demo_hk_system <span class="op">=</span> lang.CompositionSystem(name<span class="op">=</span><span class="st">"demo system"</span>, rules<span class="op">=</span>[fa, pm, pa])</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>lang.set_system(demo_hk_system)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>demo_hk_system</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Expressing denotations is done in a <code>%%lamb</code> cell, and almost always begins with lexical items. The following cell defines several lexical items that will be familiar from introductory exercises in the <span class="citation" data-cites="HeimKratzer98">Heim and Kratzer (<a href="#ref-HeimKratzer98" role="doc-biblioref">1998</a>)</span> textbook.</p>
<div class="no-row-height column-margin column-container"></div><div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>cat<span class="op">||</span> <span class="op">=</span> L x_e: Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>gray<span class="op">||</span> <span class="op">=</span> L x_e: Gray_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>john<span class="op">||</span> <span class="op">=</span> John_e</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>julius<span class="op">||</span> <span class="op">=</span> Julius_e</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>inP<span class="op">||</span> <span class="op">=</span> L x_e : L y_e : In_<span class="op">&lt;</span>(e,e),t<span class="op">&gt;</span>(y, x) <span class="co"># `in` is a reserved word in python</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>texas<span class="op">||</span> <span class="op">=</span> Texas_e</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>isV<span class="op">||</span> <span class="op">=</span> L p_<span class="op">&lt;</span>e,t<span class="op">&gt;</span> : p <span class="co"># `is` is a reserved word in python</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All object-language representations implement the interface <code>lamb.lang.Composable</code>, including lexical items as well as the complex results shown below. In type-driven mode, composition is triggered by using the ‘<code>*</code>’ operator on a <code>Composable</code>. This searches over the available composition operations in the system to see if any results can be had. Given their types, we expect <code>inP</code> and <code>texas</code> above to be able to compose using the FA rule:</p>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>inP <span class="op">*</span> texas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On the other hand <code>isV</code> is looking for a property, so we shouldn’t expect succesful composition with a type <code>e</code> element.</p>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>julius <span class="op">*</span> isV <span class="co"># will fail due to type mismatches</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Composition results are <code>Composable</code>s as well, and so can be further composed:</p>
<div id="cell-55" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sentence1 <span class="op">=</span> julius <span class="op">*</span> (isV <span class="op">*</span> (inP <span class="op">*</span> texas))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>display(sentence1[<span class="dv">0</span>].source_tree())</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sentence1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sentence1.trace()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Composition will find all possible paths, but in the current example there are no ambiguities. (Note: the metalanguage by default normalizes the order of conjuncts alphabetically, so the order in the output of PM is independent of what composes with what. This is why the operation is marked “commutative” when defined earlier – so the composition system knows it doesn’t need to bother with both orders.)</p>
<div id="cell-58" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gray <span class="op">*</span> cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gray <span class="op">*</span> (cat <span class="op">*</span> (inP <span class="op">*</span> texas))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-60" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> lang.Item(<span class="st">"a"</span>, isV.content) <span class="co"># identity function for copula as well</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>isV <span class="op">*</span> (a <span class="op">*</span> (gray <span class="op">*</span> cat <span class="op">*</span> (inP <span class="op">*</span> texas)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-61" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>np <span class="op">=</span> ((gray <span class="op">*</span> cat) <span class="op">*</span> (inP <span class="op">*</span> texas))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>vp <span class="op">=</span> (isV <span class="op">*</span> (a <span class="op">*</span> np))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>sentence2 <span class="op">=</span> julius <span class="op">*</span> vp</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>sentence2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sentence1.results[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sentence1.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-64" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sentence2.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a well-known example exercise from <span class="citation" data-cites="HeimKratzer98">Heim and Kratzer (<a href="#ref-HeimKratzer98" role="doc-biblioref">1998</a>)</span> (names different):</p>
<div class="no-row-height column-margin column-container"></div><pre><code>(1) Julius is a gray cat in Texas fond of John.</code></pre>
<p>Calculating the denotation of this is relatively straightforward, as long as the lexical items and order of composition are correct.</p>
<div id="cell-66" class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fond <span class="op">=</span> lang.Item(<span class="st">"fond"</span>, <span class="st">"L x_e : L y_e : Fond(y)(x)"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ofP <span class="op">=</span> lang.Item(<span class="st">"of"</span>, <span class="st">"L x_e : x"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>sentence3 <span class="op">=</span> julius <span class="op">*</span> (isV <span class="op">*</span> (a <span class="op">*</span> (((gray <span class="op">*</span> cat) <span class="op">*</span> (inP <span class="op">*</span> texas)) <span class="op">*</span> (fond <span class="op">*</span> (ofP <span class="op">*</span> john)))))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>display(sentence3[<span class="dv">0</span>].source_tree())</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>sentence3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sentence3.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>Composite</code> class supports indexing, so we can pull out subparts of a derivaiton:</p>
<div id="cell-69" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>parse_tree3 <span class="op">=</span> sentence3.results[<span class="dv">0</span>]</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>parse_tree3[<span class="dv">1</span>][<span class="dv">1</span>][<span class="dv">1</span>].tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There is support for traces and indexed pronouns, using a version of the Predicate Abstraction (PA) rule <span class="citation" data-cites="IFS24">(based on the version in <a href="#ref-IFS24" role="doc-biblioref">Coppock and Champollion 2024</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-IFS24" class="csl-entry" role="listitem">
Coppock, Elizabeth, and Lucas Champollion. 2024. <span>“Invitation to Formal Semantics.”</span> Lecture notes, BU and NYU. <a href="http://eecoppock.info/bootcamp/semantics-boot-camp.pdf">http://eecoppock.info/bootcamp/semantics-boot-camp.pdf</a>.
</div></div><div id="cell-71" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>binder <span class="op">=</span> lang.Binder(<span class="dv">23</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>binder2 <span class="op">=</span> lang.Binder(<span class="dv">5</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> lang.Trace(<span class="dv">23</span>, types.type_e)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> lang.Trace(<span class="dv">5</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>display(t, t2, binder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-72" class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>((t <span class="op">*</span> gray))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> (binder <span class="op">*</span> (binder2 <span class="op">*</span> (t <span class="op">*</span> (inP <span class="op">*</span> t2))))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> (binder2 <span class="op">*</span> (binder <span class="op">*</span> (t <span class="op">*</span> (inP <span class="op">*</span> t2))))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>display(b1, b2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-74" class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>b1.trace()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-75" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>b1.results[<span class="dv">0</span>].tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="composition-in-tree-structures" class="level3 page-columns page-full" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="composition-in-tree-structures"><span class="header-section-number">3.2.1</span> Composition in tree structures</h3>
<p>In many contexts it is natural to just use bottom-up composition, especially given the implementation of the PA rule. However, the lambda notebook supports arbtirarily-sequenced composition in tree structures, with deferred composition when missing bottom-up information. This uses <code>Tree</code> objects with an interface designed after those in the <a href="https://www.nltk.org/">nltk package</a>. In these derivations, you can see some of the support for inference over variable types. This composition system more directly matches the classic one presented in <span class="citation" data-cites="HeimKratzer98">Heim and Kratzer (<a href="#ref-HeimKratzer98" role="doc-biblioref">1998</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-HeimKratzer98" class="csl-entry" role="listitem">
Heim, Irene, and Angelika Kratzer. 1998. <em>Semantics in Generative Grammar</em>. Blackwell.
</div></div><div id="cell-78" class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lang.set_system(lang.hk_system)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-79" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>lamb</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>gray<span class="op">||</span> <span class="op">=</span> L x_e : Gray_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="op">||</span>cat<span class="op">||</span> <span class="op">=</span> L x_e : Cat_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-80" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> Tree(<span class="st">"S"</span>, [<span class="st">"NP"</span>, <span class="st">"VP"</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We <em>can</em> do composition in this tree fragment, but the leaf nodes (not being in the lexicon) are treated as placeholders. They are accordingly assigned polymorphic types.</p>
<ul>
<li>(The type <span class="math inline">\(\forall X\)</span> is a type that can be anything at all; this gets narrowed by each possible composition rule that could apply to a more specific but still potentially polymorphic type. PM in this system narrows to concrete property types, but each order of FA gives a polymorphic function.)</li>
</ul>
<div id="cell-82" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> Tree(<span class="st">"S"</span>, [<span class="st">"NP"</span>, <span class="st">"VP"</span>])</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> lang.compose(t2)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>r2.tree()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>r2.paths()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can supply lexical entries to form a complete tree fragment. Composition can still happen in any order, e.g.&nbsp;by default it works top down. If we compose one step the leaf node “gray” is not yet looked up; but composing the whole thing is possible.</p>
<div id="cell-84" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Tree <span class="op">=</span> lamb.utils.get_tree_class()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> Tree(<span class="st">"NP"</span>, [<span class="st">"gray"</span>, Tree(<span class="st">"N"</span>, [<span class="st">"cat"</span>])])</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-85" class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> lang.CompositionTree.tree_factory(t)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> lang.compose(t2)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-86" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>r.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-87" class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> lang.get_system().expand_all(t2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-88" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>r2.tree()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-89" class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>r2.paths()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="part-3-human-readable-rendering-of-structured-python-objects" class="level2 page-columns page-full" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="part-3-human-readable-rendering-of-structured-python-objects"><span class="header-section-number">3.3</span> Part 3: human readable rendering of structured python objects</h2>
<p>At this point in the demo, the output of the lambda notebook needs no introduction: it has been used at every stage of the document. The lambda notebook is designed from the ground up so that nearly every python class supports IPython/Jupyter’s rich outputs, rendering in human-readable form to a combination of LaTeX and HTML that can be displayed in Jupyter Notebooks <span class="citation" data-cites="Kluyver:2016aa">(<a href="#ref-Kluyver:2016aa" role="doc-biblioref">Kluyver et al. 2016</a>)</span> and on the web.</p>
<div class="no-row-height column-margin column-container"><div id="ref-Kluyver:2016aa" class="csl-entry" role="listitem">
Kluyver, Thomas, Benjamin Ragan-Kelley, Fernando Pérez, Brian Granger, Matthias Bussonnier, Jonathan Frederic, Kyle Kelley, et al. 2016. <span>“Jupyter Notebooks – a Publishing Format for Reproducible Computational Workflows.”</span> Edited by F. Loizides and B. Schmidt. IOS Press.
</div></div><ul>
<li>LaTeX math mode output in Jupyter is rendered via <a href="https://www.mathjax.org/">MathJax</a> (and on google colab, via <a href="https://katex.org/">KaTeX</a>).</li>
</ul>
<p>For example, here is an example lambda expression from earlier:</p>
<div id="cell-91" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>pmw_test1 <span class="op">=</span> <span class="op">%</span>te L p_t : L x_e : P_<span class="op">&lt;</span>e,t<span class="op">&gt;</span>(x) <span class="op">&amp;</span> p</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>pmw_test1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This object can be recursively converted into a LaTeX math mode expression, and this automatically happens when displaying such objects in Jupyter.</p>
<div id="cell-93" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pmw_test1._repr_latex_())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>More complex outputs, like composition trees, mix LaTeX and HTML output.</p>
</section>
</section>
<section id="summary" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Summary</h1>
<p>The lambda notebook provides:</p>
<ul>
<li>a flexible api/framework for implementing a logical typed metalanguage</li>
<li>a framework for implementing compositional systems based on linguistic semantics</li>
<li>an api for displaying structured objects in a linguist-readable way</li>
</ul>
<p>It does this in the context of Jupyter notebook, which further provides facilities for interleaving code (of various kinds) and documentation.</p>
<p><strong>More info</strong>: please see the many <a href="https://github.com/rawlins/lambda-notebook/tree/master/notebooks">example and documentation notebooks</a> provided with the project.</p>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/rawlins\.github\.io\/lambda-notebook\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/rawlins/lambda-notebook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>